(function(c){function wb(){E=c(window);ec=c("body");Wa=c("body, html");r=c("<div />").addClass("jackbox-modal");s=c("<div />").addClass("jackbox-holder");da=c("<div />").addClass("jackbox-wrapper");U=c("<div />").addClass("jackbox-preloader");ea=c("<span />").addClass("jackbox-panel jackbox-panel-left");oa=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=l.createDocumentFragment();a.appendChild(da[0]);a.appendChild(U[0]);r[0].appendChild(a);a=l.createDocumentFragment();a.appendChild(ea[0]);
a.appendChild(oa[0]);a.appendChild(s[0]);da[0].appendChild(a);fa=c("<div />").addClass("jackbox-container");pa||(a=c("<span />").addClass("jackbox-pre-outside").appendTo(U),c("<span />").addClass("jackbox-pre-inside").appendTo(a));V*=2;Ia=0;a=l.createDocumentFragment();xb&&(x=c(xb).hide(),a.appendChild(x[0]));a.appendChild(fa[0]);yb&&(y=c(yb).hide(),a.appendChild(y[0]));s[0].appendChild(a);zb=-(B+Aa);qa=[];Ja=[];F=[];G=[];Ab.each(ed);R&&(c.address.internalChange(Bb),c.address.externalChange(fd));
fc=!0;Ka&&(R?setTimeout(Ka,250):Ka(),Ka=null);Ab=Ja=xb=yb=qa=null}function ed(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(pa){for(var b=G.length,e=!1;b--;)if(G[b]===a){e=!0;break}e||gc(a)}else-1===G.indexOf(a)&&gc(a)}function gc(a){G[G.length]=a;Ja=[];c(".jackbox[data-group="+a+"]").each(hc);F[F.length]=Ja;Xa++}function hc(a){isNaN(a)?d=a:(d=c(this).data({id:a,cat:Xa}),Ja[a]=d);if(h=d.attr("href")||d.attr("data-href")){var b;a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop():
"inline";if(b=-1!==h.search("youtube.com")?"youtube":-1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1){if(d.data("type",b),!d.attr("data-thumbnail"))if("vimeo"===b){var e=d;c.getJSON("http://vimeo.com/api/v2/video/"+h.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"},function(a){e.attr("data-thumbnail",a[0].thumbnail_small)})}else"youtube"===b&&d.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg")}else if("jpg"===a||"png"===
a||"jpeg"===a||"gif"===a)d.data("type","image");else switch(a){case "mp3":d.data("type","audio");break;case "swf":d.data("type","swf");break;case "inline":d.data("type","inline");break;default:d.data("type","iframe")}d.on("click.jackbox",gd);if(K=d.attr("data-description")){if(qa)if(a=qa.indexOf(K),-1===a){K=c(K);if(!K.length)return;qa[qa.length]=K}else K=qa[a];else if(K=c(K),!K.length)return;d.data("description",K)}}}function fd(a){if(jc){jc=!1;var b=l.URL.split("?url=");if(2===b.length){window.location=
b[0]+"#/"+b[1];return}}clearTimeout(La);kc(a.value);-1!==C?lc?(lc=!1,Bb()):La=setTimeout(Bb,750):W&&Cb()}function Bb(a){"object"===typeof a&&(clearTimeout(La),kc(a.value));-1!==C?mc():W&&Cb()}function kc(a){H&&(!ga&&!Ba)&&t[f].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(f=parseInt(a[2],10)-1,isNaN(f)&&(f=0),ha=a[1]):isNaN(a[1])?(f=0,ha=a[1]):(f=parseInt(a[1],10)-1,ha="/")):(ha="/",f=0);if("/"!==ha)for(a=Xa;a--;){if(G[a]===ha){C=a;L=F[C].length;S=1!==L;break}}else C=-1;Ba=
!1}function Ya(){clearTimeout(nc);nc=setTimeout(ia,100)}function gd(a){a.stopPropagation();a.preventDefault();a=c(this).data();Za(a.cat,a.id,!0)}function Za(a,b,e){clearTimeout(La);if(!e){if(H)for(e=t.length;e--;)t[e].off("click.jackbox");ea.off(".jackbox");oa.off(".jackbox");$a&&ab.off("keydown.jackbox");p&&Db&&j.cjSwipe("unbindSwipe")}R?c.address.value(G[a]+"/"+(b+1)):(H&&(!ga&&!Ba)&&t[f].removeClass("jb-thumb-active"),f=b,C=a,L=F[C].length,S=1!==L,mc())}function bb(a){if(a&&(a.stopPropagation(),
Ma))return!1;W&&(H&&!ga&&t[f].removeClass("jb-thumb-active"),f<F[C].length-1?f++:f=0,Ba=!0,Za(C,f))}function cb(a){if(a&&(a.stopPropagation(),Ma))return!1;W&&(H&&!ga&&t[f].removeClass("jb-thumb-active"),0<f?f--:f=F[C].length-1,Ba=!0,Za(C,f))}function oc(){for(var a=[r[0],da[0],s[0],fa[0]],b=4;b--;)a[b].removeEventListener("touchstart",z,!1),a[b].removeEventListener("touchmove",z,!1),a[b].removeEventListener("touchend",z,!1)}function mc(){db=F[C];if(d=db[f]){if(p)for(var a=[r[0],da[0],s[0],fa[0]],
b=4;b--;)a[b].addEventListener("touchstart",z,!1),a[b].addEventListener("touchmove",z,!1),a[b].addEventListener("touchend",z,!1);h=d.attr("href")||d.attr("data-href");W?(Ma=!0,pc(),qc()):(W=!0,p||Wa.stop(),Ia=E.scrollTop(),r.appendTo(ec).one("click.jackbox",rc),Ca||(sc=r.parents().each(hd)),tc||(tc=!0,eb=parseInt(s.css("padding-left"),10)+parseInt(s.css("padding-right"),10),Da=parseInt(s.css("padding-top"),10)+parseInt(s.css("padding-bottom"),10),Eb=parseInt(ea.css("width"),10)+14,fb=Da+V,Fb=B+(Aa<<
1),gb=parseInt(U.css("margin-top"),10),uc=gb-(Fb>>1),vc=parseInt(s.css("padding-left"),10),wc=parseInt(s.css("padding-top"),10),M=c(".jackbox-fullscreen"),M.length||(M=null),ra=!p&&"safari"!==hb&&("webkitRequestFullScreen"in r[0]||"mozFullScreenEnabled"in l)),ja=!Gb&&ib&&S?0:zb,D=E.width(),I=E.height(),s.css({width:D,height:I,marginLeft:-(D>>1)-vc,marginTop:-(I>>1)-wc}),Jacked.fadeIn(r[0],{callback:id}),xc=setTimeout(qc,250),da.on("click.jackbox",yc))}}function hd(){c(this).addClass("jackbox-overflow")}
function jd(){c(this).removeClass("jackbox-overflow")}function id(){Ca||E[0].scrollTo(0,0)}function qc(){H&&(t[f].addClass("jb-thumb-active"),ga?ga=!1:Hb(!1,!0));var a=d.attr("data-autoplay")?d.attr("data-autoplay"):zc,b=d.data("description")||null,e=d.attr("data-title")||"",ic;jb="true"===d.attr("data-scaleUp");kb=b&&"string"!==typeof b?b.html():!1;N=d.data("type");e?(Ib=e,ka=escape(Ib)):(ka=!1,"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty()));p&&(Db="image"===
N,"inline"!==N&&"iframe"!==N&&l.addEventListener("touchmove",z,!1));"image"!==N&&Ac();568<D?U.css("margin-top",0===ja?uc:gb):U.css("margin-top",gb);da.show();U.addClass("jackbox-spin-preloader");switch(N){case "image":Na=!0;j=c("<img />").addClass("jackbox-content").one("load.jackbox",Oa).prependTo(fa);p&&(j[0].addEventListener("touchstart",z,!1),j[0].addEventListener("touchmove",z,!1),j[0].addEventListener("touchend",z,!1));j.attr("src",h);break;case "youtube":sa(kd.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join("true"===
a?1:0));break;case "vimeo":sa(ld.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a));break;case "local":var b=Jb(),e="true"===d.attr("data-firefoxUsesFlash")?"true":"false",Cc=d.attr("data-flashHasPriority")?d.attr("data-flashHasPriority"):Bc.toString();ic="false"===Cc&&ra&&"firefox"!==hb;b=d.attr("data-poster")?b+d.attr("data-poster"):"false";sa(md+"?video="+h+"&autoplay="+a+"&flashing="+Cc+"&width="+O+"&height="+P+"&poster="+b+"&firefox="+e,!0);break;case "audio":Jb();
sa(nd+"?audio="+h+"&title="+(d.attr("data-audiotitle")?d.attr("data-audiotitle"):ka)+"&autoplay="+a);break;case "swf":Jb();sa(od+"?swf="+h+"&width="+(k.toString()+"&height="+g.toString()));break;case "inline":a=c(h);a=a.length?a.html():"";j=c("<div />").addClass("jackbox-content jackbox-html").html(a).prependTo(fa);j.css("width",k).find("a").on("click",Dc);d.attr("data-height",j.outerHeight(!0));Ac();Oa();break;default:sa(h,!1,!0)}ra&&(!ic?M.show():M.hide())}function Jb(){if(-1===h.search("http")){var a=
l.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}}function pd(a){switch(a.keyCode){case 39:bb();break;case 37:cb();break;case 40:lb();break;case 38:lb()}}function qd(){la.css("visibility","hidden")}function rd(){q.data("offLeft",q.offset().left)}function Ec(){Ea.css({opacity:0,visibility:"hidden"})}function Fc(a){"object"===typeof a&&a.stopPropagation();u<L-ma&&(u++,mb(!1,!0))}function Gc(a){"object"===typeof a&&a.stopPropagation();0<u&&(u--,mb(!1,!0))}
function sd(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");p||a.addClass("jb-thumb-hover");a.data("id")===f&&a.addClass("jb-thumb-active")}function Hc(a){a.stopPropagation();if(Ma)return!1;a=c(this).data("id");a!==f&&(H&&t[f].removeClass("jb-thumb-active"),f=a,ga=!0,Za(C,f))}function td(){Pa?Ic():(E.off(".jackbox"),Pa=!0,l.mozFullScreenEnabled?(l.addEventListener("mozfullscreenchange",nb,!1),r[0].mozRequestFullScreen()):r[0].webkitRequestFullScreen&&(l.addEventListener("webkitfullscreenchange",
nb,!1),r[0].webkitRequestFullScreen()))}function nb(){l.webkitIsFullScreen||l.mozFullScreen?ia():Ic(!0)}function Kb(a){l.removeEventListener(a.type,Kb,!1);ia();E.on("resize.jackbox",Ya)}function Ic(a){Pa=!1;l.mozFullScreenEnabled?(l.removeEventListener("mozfullscreenchange",nb,!1),a?(ia(),E.on("resize.jackbox",Ya)):(l.addEventListener("mozfullscreenchange",Kb,!1),l.mozCancelFullScreen())):r[0].webkitRequestFullScreen&&(l.removeEventListener("webkitfullscreenchange",nb,!1),a?(ia(),E.on("resize.jackbox",
Ya)):(l.addEventListener("webkitfullscreenchange",Kb,!1),l.webkitCancelFullScreen()))}function Ac(){Na=!1;O=d.attr("data-width")?parseInt(d.attr("data-width"),10):Jc;P=d.attr("data-height")?parseInt(d.attr("data-height"),10):Kc;jb="true"===d.attr("data-scaleUp");Lc()}function Lc(){ob=O+eb+Eb+V;Lb=P+fb;ia("true")}function pc(){clearTimeout(xc);Jacked.stopTween(s[0]);E.off(".jackbox");p&&l.removeEventListener("touchmove",z,!1);j&&(Jacked.stopTween(j[0]),j.remove(),j=null);pb&&(pb.remove(),pb=null);
x&&(Jacked.stopTween(x[0],!0),x.hide());y&&(Jacked.stopTween(y[0],!0),y.hide());v&&(v.removeClass("jb-info-inactive"),Jacked.stopTween(J[0]),J.empty().hide())}function rc(a){a.stopPropagation();R?c.address.value(""):Cb()}function Cb(){clearTimeout(La);pc();r.unbind(".jackbox");if(S){$a&&ab.off("keydown.jackbox");ta&&ta.off(".jackbox");ua&&ua.off(".jackbox");Qa&&q&&q.off(".jackbox");Jacked.stopTween(oa[0],!0);Jacked.stopTween(ea[0],!0);var a={opacity:0,visibility:"hidden"};oa.off(".jackbox").css(a);
ea.off(".jackbox").css(a)}else va&&va.show(),w&&w.show();da.hide().off(".jackbox");U.removeClass("jackbox-spin-preloader");"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty());ra&&M.off(".jackbox");wa&&wa.unbind(".jackbox");v&&v.off(".jackbox");if(H){Jacked.stopTween(X[0]);for(X.off(".jackbox").hide();t.length;)a=t[0],Jacked.stopTween(a[0]),a.remove(),t.shift();Y.off(".jackbox").hide();Z.off(".jackbox").hide();p&&q.cjSwipe("unbindSwipe");Jacked.stopTween(Q[0]);Q.empty().css("margin-left",
0);w&&(w.off(".jackbox"),w&&(T.hide(),$.show()));H=t=null}Ca||sc.each(jd);Jacked.fadeOut(r[0],{duration:1E3,callback:ud});s.css({marginLeft:vd,marginTop:wd});p&&(oc(),l.removeEventListener("touchmove",z,!1));setTimeout(xd,10);la&&la.css("visibility","hidden");d=W=Pa=ga=Mb=qb=Ba=Nb=Fa=null}function xd(){0!==Ia&&(!Ca&&!p?Wa.animate({scrollTop:Ia},{duration:300,queue:!1}):Wa.scrollTop(Ia))}function ud(){r.detach()}function yd(a){!a?bb():cb()}function z(a){a.preventDefault()}function zd(a,b){if(!W&&"success"===
b.toLowerCase()&&a){var e=a.length,d=document.URL;for(d.substring(0,d.lastIndexOf("/"));e--;)c("<img />").attr("src",Ad+"/"+a[e].split("../").join(""))}}function Bd(){var a=c(this),b=a.next("img"),e=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",Cd).insertAfter(b),b.remove(),a.attr("src",e))}function Cd(){var a=c(this),b=a.data("parent"),e=parseInt(b.css("width"),10)||b.width(),d=parseInt(b.css("height"),10)||b.height(),
b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:e,height:d}).insertBefore(b),d=Date.now(),e=d+1,d=d+2;a.attr("id",e);b.attr("id",d);StackBlurImage(e,d,29)}function Dd(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",Ed).on("mouseleave.jackbox",Fd)}function Ed(){var a=c(this),b=a.offset(),e=a.data();e.tipX=b.left;e.tipY=b.top;e.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox",Mc)}function Fd(){var a=c(this).off("mousemove.jackbox");
pa?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0,visibility:"hidden"})}function Dc(a){a.stopImmediatePropagation()}function yc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var m={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540,thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,showPageScrollbar:!1,useKeyboardControls:!0,fullscreenScalesContent:!0,
defaultShareImage:"jackbox/img/default_share.jpg"},V=10,Aa=2,Ad="jackbox",Gd=templateDir+"/inc/jackbox/php/graphics.php",od="jackbox/modules/jackbox_swf.html",md="jackbox/modules/jackbox_video.html",nd="jackbox/modules/jackbox_audio.html",Hd=templateDir+"/inc/jackbox/modules/jackbox_social.php",ld="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent",kd="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",
xb='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />',yb='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>',
nc,y,ra,vc,wc,Ob,Fb,rb,zb,Pa,Pb,Nc,Da,eb,Oc,la,Eb,Qb,Q,q,Rb,Z,x,J,aa,T,$,oa,M,Ia,ea,ka,Y,fa,U,ma,qa,Sb,Ib,Db,Fa,Ea,ja,w,wa,kb,va,Pc,Qa,Qc,xa,Ga,u,da,ya,ua,S,gb,ta,jb,Rc,p,fb,sb,Ra,r,A,d,Ja,v,ab,l,h,k,E,L,Sc,G,g,ha,F,pa,za,Tb,xc,Ka,t,ec,s,Ab,O,tb,La,Tc,j,P,Na,D,I,ob,Lb,N,sc,hb,ba,K,W,tc,Wa,$a,ib,Ma,ga,H,wd,Mb,db,Ca,R,Sa,pb,X,qb,uc,vd,Uc,Ba,Ub,Nb,zc,ca,fc,B,Bc,Vc,Wc,Gb,Jc,Kc,f=1,C=-1,Xa=0,lc=!0,jc=!0,Xc={init:function(a,b){!Uc&&"undefined"!==typeof Jacked&&(b&&c.extend(m,b),ib=m.useThumbs,R=m.deepLinking,
Qa=m.useThumbTooltips,zc=m.autoPlayVideo,$a=m.useKeyboardControls,Ca=m.showPageScrollbar,ca=m.thumbnailWidth,Tc=m.fullscreenScalesContent,B=m.thumbnailHeight,Bc=m.flashVideoFirst,Wc=m.showInfoByDefault,Gb=m.thumbsStartHidden,Vc=m.defaultShareImage,Jc=m.defaultVideoWidth,Kc=m.defaultVideoHeight,l=document,ab=c(document),Uc=!0,ba=ca+Aa,tb=-1!==l.URL.search("file:///"),Jacked.setEngines({ios:!0,safari:!0,opera:!0,firefox:!0}),m.preloadGraphics&&!tb&&c.getJSON(Gd+"?jackbox_path=../img/graphics/",zd),
Ab=a,m=null,pa=Jacked.getIE(),p=Jacked.getMobile(),hb=Jacked.getBrowser(),Sc="ie"===hb,p&&(Ca=!1),"undefined"!==typeof c.address&&R?Sc?(wb(),c.address.update()):c.address.init(wb):(R=!1,wb()),"undefined"!==typeof StackBlurImage&&(!tb&&!pa)&&c(".jackbox-hover-blur").each(Bd),c(".jackbox-tooltip").each(Dd))},frameReady:function(){W&&Oa()},newItem:function(a,b){var e=G.length,c=-1,d;if(b&&"object"===typeof b){var f,g,j;for(f in b)"trigger"!==f&&(g="data-"+f,j=b[f],a.attr(g,j),"group"===f&&(d=j))}else b=
null;d||(d=a.attr("data-group"));if(d){for(d=d.split(" ").join("").toLowerCase();e--;)if(G[e]===d){c=e;break}if(-1<c){d=F[c];for(var k in d)if(d[k[0]][0]===a[0])return;e=d.length;d[e]=a}else c=G.length,e=F.length,G[c]=d,Xa++,F[e]=[a],e=0;hc(a);a.data({id:e,cat:c});b&&b.trigger&&a.trigger("click")}}},sa,ub={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};sa=function(a,b,e){ub.width=k;ub.height=g;
ub.scrolling=!e?"no":"auto";j=c("<iframe />").attr(ub).addClass("jackbox-content").prependTo(fa);if(!b)j.one("load.jackbox",Oa);j.attr("src",a)};var Oa,Vb={};Oa=function(a){a&&a.stopPropagation();Na&&(O=this.width||j.width(),P=this.height||j.height(),Lc());Vb.width=k;Vb.height=g;j.css(Vb);Wb(!0);Pb&&Pb();E.on("resize.jackbox",Ya)};var Wb,na={},Ha={},Ta={};Wb=function(a){if(a){260>k&&(za+=260-k);a=Math.max(k,260);if(a===Fa&&g===Sb){Xb();return}na.callback=Xb;na.duration=Fa?50<Math.abs(a-Fa)||50<Math.abs(g-
Sb)?600:300:600}else a=k,Ta.width=a,na.duration=300,delete na.callback,x&&Jacked.tween(x[0],Ta,na),y&&Jacked.tween(y[0],Ta,na),Ta.height=g,Jacked.stopTween(j[0],!0),Jacked.tween(j[0],Ta,na);Ha.marginLeft=-((za>>1)+0.5|0);Ha.marginTop=-((Tb>>1)+0.5|0);Ha.height=g;Ha.width=a;Fa||(Ha.opacity=1);Jacked.tween(s[0],Ha,na);Fa=a;Sb=g};var Xb,Ua={},Yc={opacity:1,visibility:"visible"};Xb=function(){Zc();U.removeClass("jackbox-spin-preloader");var a=Math.max(k,260);Ua.duration=600;Na&&!pa?Jacked.fadeIn(j[0],
Ua):(j.show(),("audio"===N||"local"===N)&&j[0].contentWindow.cjInit());Ua.duration=300;pa?(x&&x.css("width",a).show(),y&&y.css("width",a).show()):(x&&(x.css("width",a),Jacked.fadeIn(x[0],Ua)),y&&(y.css("width",a),Jacked.fadeIn(y[0],Ua)));v&&kb?(v.show(),J.html(kb).show(),aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Wc?(Ga=!0,v.addClass("jb-info-inactive"),J.css({visibility:"visible",marginTop:0})):(Ga=!1,J.css("margin-top",aa))):v&&(v.hide(),J.hide());Ma=!1;!qb&&S&&(ea.css(Yc),oa.css(Yc));if(!Nb&&
ib&&S){var a=F[C],b=[],e=L,d,f,h,n,m;for(Nb=!0;e--;)h=a[e],h.attr("data-thumbnail")?b[e]=!1:(d=h.children("img"),d.length?(h.attr("data-thumbnail",d.attr("src")),b[e]=d):("image"===h.data("type")?h.attr("data-thumbnail",h.attr("href")||h.attr("data-href")):h.attr("data-thumbnail","jackbox/img/thumbs/default.jpg"),b[e]=!1));t=[];X||(e=l.createDocumentFragment(),h=B>>1,X=c("<div />").addClass("jackbox-thumb-holder").css("height",B).appendTo(r),q=c("<div />").addClass("jackbox-thumb-panel").css("height",
B),Z=c("<div />").addClass("jackbox-thumb-right"),Y=c("<div />").addClass("jackbox-thumb-left"),e.appendChild(q[0]),e.appendChild(Z[0]),e.appendChild(Y[0]),q[0].cjThumbs=!0,X[0].appendChild(e),Q=c("<div />").addClass("jackbox-thumb-strip").appendTo(q),Y.css("top",h),Z.css("top",h));h=l.createDocumentFragment();for(e=0;e<L;e++){f=t[e]=c("<div />").data("id",e).addClass("jackbox-thumb").css({width:ca,height:B,left:ba*e}).on("click.jackbox",Hc);if(Qa&&(d=db[e].attr("data-thumbTooltip")||db[e].attr("data-title")))f.data("theTitle",
d).on("mouseenter.jackbox",$c).on("mouseleave.jackbox",Ec);h.appendChild(f[0]);d=c("<img />").addClass("jb-thumb").one("load.jackbox",sd).appendTo(f);f.data("theThumb",d);b[e]?(f=b[e].attr("width")||b[e].width(),n=b[e].attr("height")||b[e].height()):(f=ca,n=B);f>ca&&n>B&&(m=f>n?ca/f:B/n,f*=m,n*=m,n<B&&(m=(B-n)/B,f+=f*m,n+=n*m),f<ca&&(m=(ca-f)/ca,f+=f*m,n+=n*m),f!==(f|0)&&(f=f+1|0),n!==(n|0)&&(n=n+1|0));d.attr({width:f,height:n,src:a[e].attr("data-thumbnail")})}Q[0].appendChild(h);Oc=t.length;Rb=ba*
e;H=!0;u=0;X.on("click.jackbox",yc).show();Yb();w&&(Gb?($.hide(),T.show(),X.css("bottom",ja)):(T.hide(),$.show(),X.css("bottom",0)),w.on("click.jackbox",lb))}if(!qb){qb=!0;if(ra)M.on("click.jackbox",td);if(wa)wa.one("click.jackbox",rc);if(v)v.on("click.jackbox",ad);if(S){if(ua)ua.on("click.jackbox",bb);if(ta)ta.on("click.jackbox",cb);if(Qa&&q)q.on("mouseenter.jackbox",rd)}}p&&(j[0].removeEventListener("touchstart",z,!1),j[0].removeEventListener("touchmove",z,!1),j[0].removeEventListener("touchend",
z,!1),oc());if(S){if(H)for(a=t.length;a--;)t[a].on("click.jackbox",Hc);ea.on("click.jackbox",cb);oa.on("click.jackbox",bb);if($a)ab.on("keydown.jackbox",pd);p&&Db&&j.cjSwipe("touchSwipe",yd)}};var Zc,vb={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};Zc=function(){if(!Pc){Pc=!0;Ra=c(".jb-total");v=c(".jackbox-info");xa=c(".jb-divider");ya=c(".jb-current");wa=c(".jackbox-close");
sb=c(".jackbox-title-text");A=c(".jackbox-title-txt");va=c(".jackbox-controls");ta=c(".jackbox-arrow-left");Sa=c(".jackbox-social");ua=c(".jackbox-arrow-right");w=c(".jackbox-button-thumbs");T=c(".jackbox-show-thumbs");$=c(".jackbox-hide-thumbs");A.length||(A=null);sb.length||(sb=null);ta.length||(ta=null);xa.length||(xa=null);ua.length||(ua=null);va.length||(va=null);wa.length||(wa=null);Sa.length||(Sa=null);if(!ya.length||!Ra.length)ya=null;ra?(c(".jackbox-ns").hide(),M.length||(M=ra=null)):M&&
M.hide();ib?w.length&&T.length&&$.length?T.hide():w=T=$=null:(w.hide(),w=T=$=null);v.length?(la=c("<div />").addClass("jackbox-info-text").appendTo(fa).css("visibility","hidden"),J=c("<div />").addClass("jackbox-description-text").appendTo(la)):v=null;Qa&&(Ea=c("<span />").addClass("jackbox-thumb-tip").css("bottom",B),Ob=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Ea),Ea.appendTo(r),Nc=(parseInt(Ea.css("padding-left"),10)<<1)-(Aa<<1))}S||(va&&va.hide(),w&&w.hide());
if(sb){"false"===ka&&(ka=!1);var a=A&&ka,b=a?" -&nbsp;":"";ya&&S?(ya.text(f+1).show(),Ra.html(L+b).show(),xa&&xa.show()):(Ra&&Ra.hide(),ya&&ya.hide(),xa&&xa.hide());a&&(A.html(Ib),a=A.find("a"),a.length&&(a.on("click.jackbox",Dc),A.data("links",a)))}if(Sa&&!tb){var e,a=l.URL.split("#")[0],b=a.length-1;-1!==a.search("/")&&("/"!==a.charAt(b)?(R?e=a+"#/"+ha+"/"+(f+1):e=a,a=a.substring(0,a.lastIndexOf("/"))):(a=a.substring(0,b),R?e=a+"/#/"+ha+"/"+(f+1):e=a));Na?b=d.attr("href")||d.attr("data-href"):(b=
d.children("img"),b=b.length?b.attr("src"):Vc);-1===b.search("http")&&(b="/"!==b.charAt(0)?a+"/"+b:a+b);vb.width=200;vb.height=21;vb.src=Hd+"?url="+encodeURIComponent(e)+"&poster="+encodeURIComponent(b)+"&title="+(ka?escape(ka.replace(/(<([^>]+)>)/ig,"")):escape(l.title));pb=c("<iframe />").attr(vb).appendTo(Sa)}};var ad,Zb={},$b={duration:300};ad=function(a){a&&a.stopPropagation();Ga?(Zb.marginTop=aa,$b.callback=qd,v.removeClass("jb-info-inactive")):(v.addClass("jb-info-inactive"),la.css("visibility",
"visible"),Zb.marginTop=0,delete $b.callback);Jacked.tween(J[0],Zb,$b);Ga=!Ga};var $c,ac={opacity:1,visibility:"visible"};$c=function(){p&&(clearTimeout(Rc),Rc=setTimeout(Ec,2E3));var a=c(this),b,e,d;Ob.text(a.data("theTitle"));b=parseInt(Ob.css("width"),10);d=q.data("offLeft");a=a.offset().left;e=d+q.width()-b-Nc;ac.width=b;ac.left=a<d?d:a>e?e:a;Ea.css(ac)};var lb,bd={},Id={duration:300};lb=function(a){a&&a.stopPropagation();0===ja?(ja=zb,w&&($.hide(),T.show())):(ja=0,w&&(T.hide(),$.show()));bd.bottom=
ja;Jacked.tween(X[0],bd,Id);569>D||(ia("true"),Wb())};var Yb,bc={};Yb=function(a){var b=D-160;Rb<b?(ma=Oc,Ub=!1):(ma=b/ba|0,Ub=!0);rb=ba*ma-Aa;Qb=ma-1;bc.marginLeft=-(rb>>1)-Aa;bc.width=rb;q.css(bc);Q.css("width",Rb);Hb(a)};var Hb,cd={},Jd={duration:300};Hb=function(a,b){if(a)u=f,0!==f&&f+ma>L&&(u=L-ma),Jacked.stopTween(Q[0]),Q.css("left",u*-ba);else{if(0===f)u=0;else if(f>u+Qb)for(;f>u+Qb;)u++;b?(cd.left=u*-ba,Jacked.tween(Q[0],cd,Jd)):(Jacked.stopTween(Q[0]),Q.css("left",u*-ba))}mb(a,!1)};var mb,
dd={},Kd={duration:300};mb=function(a,b){Y.off(".jackbox");Z.off(".jackbox");if(Ub)if(p&&q.cjSwipe("unbindSwipe"),u<L-ma?(Z.on("click.jackbox",Fc).show(),p&&q.cjSwipe("touchSwipeLeft",Fc,!0)):Z.hide(),0<u?(Y.on("click.jackbox",Gc).show(),p&&q.cjSwipe("touchSwipeRight",Gc,!0)):Y.hide(),b)dd.left=u*-ba,Jacked.tween(Q[0],dd,Kd);else{if(a||!Mb){var c=q.offset().left;Y.css("left",c);Z.css("left",c+rb);Mb=!0}}else Y.hide(),Z.hide()};var ia,cc={opacity:1},Va={};ia=function(a){D=E.width();I=Math.max(E.height(),
226);var b=568<D&&0===ja?Fb:0;Qc="audio"!==N&&"inline"!==N?!Pa?jb:jb||Tc:!1;if(ob<D&&Lb+b<I&&!Qc)k=O,g=P;else{k=D/ob;g=I/Lb;var c=k>g?g:k;k=O*c;g=P*c;D>I?g+fb+b>I&&(g=I-Da-V-b,k=O*(g/P)):k>g?k+ob>D&&(k=D-V,g=P*(k/O)):g+fb+b>I&&(g=I-Da-V-b,k=O*(g/P));k!==(k|0)&&(k=k+1|0);g!==(g|0)&&(g=g+1|0)}if("inline"===N){var c=D-eb-Eb-V,d=I-Da-V-b;k=O>c?c:O;g=P<d?P:g}za=k+eb;Tb=g+Da+b;"true"!==a&&(Jacked.stopTween(s[0],!1,!0),j&&Jacked.stopTween(j[0],!0,!0),260>k&&(za+=260-k),a=Math.max(260,k),cc.width=a,cc.height=
g,Va.marginLeft=-(0.5*za+0.5|0),Va.marginTop=-(0.5*Tb+0.5|0),Va.width=a,Va.height=g,s.css(Va),j.css(cc),y&&(Jacked.stopTween(y[0]),y.css("width",a)),x&&(Jacked.stopTween(x[0]),x.css("width",a)),v&&kb&&(aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Ga||(Jacked.stopTween(J[0],!1,!0),J.css("margin-top",aa))),H&&Yb(!0))};var Mc,dc={};Mc=function(a){var b=c(this).data();dc.left=a.pageX-b.tipX-b.tipWidth;dc.top=a.pageY-b.tipY-b.tipHeight;b.tip.css(dc)};c.fn.jackBox=function(a,b){if(Xc.hasOwnProperty(a))Xc[a](this,
b)};c.jackBox={available:function(a){a&&(fc?R?setTimeout(a,250):a():Ka=a)},itemLoaded:function(a){Pb=a}}})(jQuery);function jackboxFrameReady(){jQuery.fn.jackBox("frameReady")};